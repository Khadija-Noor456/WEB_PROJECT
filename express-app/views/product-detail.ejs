<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title><%= title %></title>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Lato:wght@300;400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/css/style.css">
</head>
<body>
  <%- include('partials/header') %>

  <section class="product-detail">
    <div class="container">
      <a href="/shop" class="back-link">← Back to Shop</a>
      
      <div class="product-detail-content">
        <div class="product-detail-image">
          <img src="<%= product.image %>" alt="<%= product.name %>">
        </div>

        <div class="product-detail-info">
          <span class="product-category"><%= product.category %></span>
          <h1><%= product.name %></h1>
          
          <% if (product.rating > 0) { %>
            <div class="rating-display">
              <span class="stars">⭐⭐⭐⭐⭐</span>
              <span class="rating-number"><%= product.rating %> / 5</span>
            </div>
          <% } %>

          <div class="product-price-large">$<%= product.price.toFixed(2) %></div>

          <p class="product-description-full"><%= product.description %></p>

          <div class="product-meta">
            <div class="meta-item">
              <strong>Stock:</strong> 
              <% if (product.stock > 0) { %>
                <span class="in-stock"><%= product.stock %> available</span>
              <% } else { %>
                <span class="out-of-stock">Out of stock</span>
              <% } %>
            </div>
            <div class="meta-item">
              <strong>Category:</strong> <%= product.category %>
            </div>
          </div>

          <div class="product-actions">
            <% if (product.stock > 0) { %>
              <button class="btn btn-large">Add to Cart</button>
              <button class="btn-secondary btn-large">Add to Wishlist</button>
            <% } else { %>
              <button class="btn btn-large" disabled>Out of Stock</button>
            <% } %>
          </div>
        </div>
      </div>

      <!-- Related Products -->
      <% if (relatedProducts.length > 0) { %>
        <div class="related-products">
          <h2>Related Products</h2>
          <div class="products-grid">
            <% relatedProducts.forEach(relatedProduct => { %>
              <div class="product-card">
                <a href="/product/<%= relatedProduct._id %>">
                  <div class="product-image">
                    <img src="<%= relatedProduct.image %>" alt="<%= relatedProduct.name %>">
                  </div>
                  <div class="product-info">
                    <span class="product-category"><%= relatedProduct.category %></span>
                    <h3 class="product-title"><%= relatedProduct.name %></h3>
                    <div class="product-footer">
                      <span class="product-price">$<%= relatedProduct.price.toFixed(2) %></span>
                    </div>
                  </div>
                </a>
              </div>
            <% }) %>
          </div>
        </div>
      <% } %>
    </div>
  </section>

  <%- include('partials/footer') %>
</body>
</html>